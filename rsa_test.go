package ende_test

import (
	"context"
	"testing"

	"github.com/stretchr/testify/assert"
	"github.com/yusufsyaifudin/ende"
)

const (
	PrivateKeyBase32 = `
FUWS2LJNIJCUOSKOEBIFESKWIFKEKICLIVMS2LJNFUWQUTKJJFFEWUKJIJAUCS2DIFTUKQLVGNEW2SDXJEXUM4TBIVVFKS3KGZMVUSJSPF3WUZ3VOVTTG5BSMJVWKMTVGYYHQNCGIU4EQSDXOBLAU5TKNIZS6ZCOINLEE6KUPFYDOQLXMY3E4OCDGJQTGVCQF5HFQT2GNBEWQTSMIVHXSTJLGVJESTBQPBKVQSCUPBBTKSSXNVLC6YL2JBCQUUCDJZWVAQ3WJYXUSVSNKNDVGVRYJYZFCURSOBGG4M3GKB2WC3CLHEZUKYSXPF4GG5KBNRUUW3BWFN5EG6JSLFHUE4CLGBRWK6LGINDQU4KXGEZVKOLVG52VC5LROIYGGT2ILI3TCM22GB5EU2COONYUSL3VJ5ZVGS2KMNDGIK2QHBGXM3CMLF4UWQ2BM5UXKK3KII3TAQ2IKQ2QUULVOFXXC6DTKRKE2TTYKRRTG6RLLB3HU2TSMRXFSODBKFRDIY3XOM2TCL2VNFSC6M2XNNCTSOCUOFHXK2KIOVRS6MDQONRUUSTNKJEAU5LYJE4G45SYJNEUIR3KO4VXI5KGKAYVMKZPII3TCMLLIV4UYQLPGBVVUTDTPF4FQYLJMZ3VGOJXJIVTOVDDI5WHCN2NK5RTEURQPFBQUNCDORCHEMLXGB2VUZLSO5NHE2TSLFSVOVJYFNHDA43LO5BVMS3JKAXVM4C2LBXHSWSXNNISWVZWKZNDGOCNGJ3UEU3XINKFIMSFIZSQU3LRMN5HIWLFOFHTS5CFOJ2WKQJQIFTVEWSXOVFVK2ZSIEYEW4JRHFRUCYRPGNHFONKOGBWTENJQME2VOSCOFNYXO3DWGFBXA2BXMJEQURZXGVKFQZTRGIZWSULKNBRVINSKJNDGWL2QGJJGQNDVLA3XMU3XPAVUITKRNNYGWQLGNZWVCSCFJRXFQVLGJFKEGL2PPI2WWZKKGBKQUOJXIJTDMTCIHE3XOZTINFBFKSZSO44W6ZLEJ4YEQWTSIE2VOL3JF5KEWNJYJBLXAYLWJNBFUZKEMZYHIRCGNZKVM4SPLFTFUT3ZKY4AUTDRNB3ES6SDPFVHOV2WNNFVARTJLE2UK5DFKZAU44LKMRBXOSTNGBVUEMRQF54ECM2MNRFWU5LLK5IXE6JXGZZHQNLPNZGUGQLXIVAQUQKRJNBUCZ2FIFZXMNJPHFFUENTJNIXWWTRZNBYEOYTJJBXGMTRWKBQXS52RFNDXK2LYGFCEWYKJOVCUSYLFONCDSNCQKZ2TSUSIHBLQUR3BMZXVSVS2KRVDE6BXJVSHUNTXPJ5EEK3EJRCXE6DIKJJVQR3KNUXTSNKMKNATSRTIG54UYNS2MJWVU6SPNZUGONJULF2VKTTVKZDAU32GOZJHS3DEPE3XUMKFLIYDGVDYKFMHKTKNMEVXIYLDNVVGY5SBMRWVMUDGNRFFQTSEK5DU65KCKF5FO2TVOQ3XKZDFF5CHSUBPOZLQUT2SIF3S6NDVIVYVI2KBLJATEWCLIVRG6UDEMFVGWUZXLJDE4Q3GGRTVAN3TKVZC62CDLB3VKVRRM5QWOR3TGJ2DMSLPINIGO6KQKBVAUN2DOU4TMS2SIEYC6NKQKIXXIUCHLBEWY5TSOFCUCU2ENUYGQYLYF5KVS4BTNNTUM5SCMNGWISRRNVREMULPJFYWG2RYIRWXEOLDMVKQUS3LLA4HG2TXIJHEYM3UFM4VMYSEKBZU63SHGNGHEWCBF5DTQ2TCNJLFK3KKGJJUENDQFNRVAVT2JQYE43JZNZMVC6KRHBJU4Y2JKZGAU22LGBIUEOLVJ5NE6RDVMFZGIODTON4EWMCTIVJWEVLEG53XQUKUKBDXIU3EJRKEQTCBIREEKM2RGNLEO2SCMNEFS5SNJZMXSSLXPFUQU2DKJJTUU3ZXNY4CWWTHMVRFC2LENBETG3CXO5AXMVJVGFLUWVKQNZ4DIQTNK55EUT3GNNTGQ2CGJVZUGUCYPBXGW4DEONVEWWKIMI2QU4DLKZ2FIZDJJRUS6UTONF4EKUSLGBTFU4CBOF4XCNSHNRGUY4DRIVEGWU3TLEYHMVDGJY4DOK3IPFJVINLGN5VVSMK2IFTFAU2CNZRQUR3GMRQXSTBUJZ3VUZRSGBIGI2RZGVCWMWRPOJDEC2RWJBZVIRTQN5HXK6CRJNSXQNRUNJBFA2TUNMVTEMCTGI2WEM3SNZZDQMDFKJDAUSSUNV2XU6DLLFQVCU2QNRWXMMBLKF4FMQZLF4YU6TCUORCTIOJZJZWW42BRLJ5HKVCWFMYHO5SGKM4VIRKDM5TUKQSBJZBHKSSTM5MAUVLEJVZS6S2CN55EQM3FI5VHA5LWONME4Z3IKVVHU5CGLFFUEQ32HE2TE6SSLJZE63BLJ5WUCUJRMM2HIVCMJVWDQR3IJQXTM6SON5TAUVDQPF4FCSZPIE3UYOKTKJDFG4KKMJRXASKNNFWXI2BVMQVS6TLOON2TI43GJBXDM2SFMN3E23KKPA2S6NLYKA3WO22SKRJSW6KSOM3AUMBRKZ2G25CZKQ4EWRKPHA2UC5SQOZFE2U3HGBYVCVJVKNDVO5LYNNTWQWTUF5KE6U32PIZXIMTGONKDST3NNFEUSTBXNBYG2VSMKA4QU4LGGNBW25CFLBYES5JVJBMGU2JVJRBTQOBXKVWHG6SCLE3VQN2QKRFTEMDKPFBWKUKDGFVFSZTDJZKDIRZPJA4W6MKRI5CTIVDKJVVAUVDXMRCGMMKTJ4ZTKNDTKJLU23BSJRKW4K2GJBXXGR3YGNFW6Z2DJFGDOT2II5HFKNDSNB4EENTTKZHFIML2NVEW2S32NVZW44DZKNIQUL2RLBCEOUDMNA4HO6SCGZFTQQ3HM5CUEQKPLE2TSZLJINGGMSCTI5FXQR2XNJAUY53HMF3GML2IM5GWYUTMJY2WCTSZMREFQQ2TIFVAUYRZMJDWQ3CGGRMFMNCUPBZXKMSENZ5GIVRQLFHHMNRPNRAXEOKCJ5TWGYJQGJMFCZJQN5EUOYKSJF2EYNSHMV3FS5KWMVKHINLCJZBAUT2FMNAUYWDBHFWWO5LDGU2GIOCHMQ3VGU2SNFHTQZDBKZ3HUSBSIQZW4RCRKRBWCOCTMVFGYUDKM5RXK5CSIE4XSK3LHBUXM6LHIU3AU3ZWOM2WIR2IK5DFKQLIIZZEU3JTHE2XON22OFZDISBTJFFFQ5TIKZJWYMCNLIXTO53QKNLU4MRQOM4HG3LHNJYGSQ3QGFBU4VCXPB2QU3DQMFDFEULNINNDS5TDOBYTSTDUNFBHI2CRKJ3G2TZYJNAUITSPNVLGIVKXNR5GU5SNK4ZUI2KHORMDO5KDMFKTGMLNMFTTS5KBIVWAURLCOJRDQ5DBNBMFKYKOMRSW4YRZOFBW4URZFNWTG23QNBSGCODDO44ECM3RGBIE22JTGBBWOZ2FIFEHKRCDMRWTQRRLGBAUMNSRNU4QU2LDKFLXAS2OGFSGENLEKVBDK5JXIVYWOSCPIZRWQS3UNJLTE6SSPFREYMKJOZFW6MKCMVFVIZCPMNNFC2KWO5YGC6LXMJXHG5KGPJTAUZDGKNHEMUCINNBG4OJYKVHDESTZGNIG2K2IGNTUQ6SMJYVWQQLQJNTDMTZLGFBWK4LVGVBUQMLJLFIEE23SNQXUSZKEOVCGKK2HN5NAUMDWJJ4EOT2JGI4UEUTKKFBESTDGJR3GSODKLJZFGUDUOBYWWWCKNRQTE4CLKNRTAS2FNZQW4VSHIJETONCYKBDGGUCFKAZTQ2JUHF4QUSCCKQXWUY2JNZLVE5KWIN5GOYTMJVKUQNDJOA2TCSRUKVHWSUCYOBBUOK2DJNUWESRYINLHS3SEOJFWE5RWONRTOQKULBMXIYTFPFAQU4LNIVYW63LBMY4VGNSIORVEWL3VIVEHETTIGBBWY5KILFBU243YNIYXKSC2IV3VAQ2CPFITQNDEPB5HSULGOVSVSVJVMY3GSTZUMZGQUUTXGZIEM52LINAVCRKBOJUXK6SLMM4HSU3WOVJXQ5KJINMU2N2FLBYUU5LWJ5EEY43BKZJFESLIGVHEQTDMGZEFU3LRMFWE6L2GOQVQUNLZNMZC6KZUMZKDOOL2O53CW4TXJRXVKTTGKIZG4ZKGNBUEO22RNZFFKOCNJZVUCUSCJVTSW6CWMF5GMSTDIVBHSTCJON2XU3KWGBTAUS2TJB2TC42UIFEFUNDHPBXDSOJTMNKXUKZLO5MEKUTSPFHW4OBZMFNGMZ2KHFUEM3KGNFLC6MRTFNBDK3CWPJLECN3FMREGQ2DIJNRAU6KRKEXVKNCBLFNFCULYF5ITEQ3SINLTM3DENVDXML2HPJUVKRCCNQXTSODUO4VUOTC2ORLHQWCNPFSVASLULBFGEZCQMNYGG6SEIRXAU5LBIZMVGTJSKNMHUMZXNY3XIOLJGNWVUWSUMRLE233HKNJEW5SWOFATI53MOJDSWOLWIJLUK2SCGNYXA5TNNRFGG2LSOFQXMTSFNFXAUZCEKNMXKKZYGR4VU3CEFNYU2WCFIZNGSM3CJY2U2L2YOBVDAVL2KVIUWQ2BKFBGYT2WGF5HUS3HMRGCW4K2GJFWKRTXNRUUW6SINVEQU5ZUJJJHCSLLHF4DI5STIIZWIUTDOVWFI3DFM5VWSV3GKU3HKYRZIFFDS6SBNEXWS2S2MJ5FSUCDGFMVGUCPOY3WEL2ZMVHVKWKIPFRQUVTQG5QUQ6KKIVEUGUDMKJWUYSKWIVEWOVBVI5FDOMCGMVSGUMCCKRFFSUCFK5GWS6RPN5SEC53XNVJGGR2YNJGG43TYPF4GU6SCLIYAU5LFIU3WOQKUIVEDA6TKGFIG63DQNEYGKZKTOVDWWSBYK5LGCWSCNVWFQ3DOF4YGQL3XOFJHCZKPK4XXUTLGKVLHI4SFMV4DK2SNGBCQUUDWN5ZTST2CGA3VQRDKIFLWSUSQNZCDKOCUKBWVA4JWK54GOUTQI5KXEZTUIRJWKMKRIRUUIN3KNBDHSZKTKY4VU3TVNZWXQNBVHBWQURBLPBCTML2SIFYG4U3EOFWEYYKOKZYDAZ3RPAZFAYRXKFXVARSCJJSWM23ONRBEKVJSLJXXS2LNJR5G64KEJ42FMV3TPJJXMCRNFUWS2LKFJZCCAUCSJFLECVCFEBFUKWJNFUWS2LIK
`

	PublicKeyBase32 = `
FUWS2LJNIJCUOSKOEBIFKQSMJFBSAS2FLEWS2LJNFUFE2SKJINBWOS2DIFTUKQLVGNEW2SDXJEXUM4TBIVVFKS3KGZMVUSJSPF3WUZ3VOVTTG5BSMJVWKMTVGYYHQNCGIU4EQSDXOBLHM2TKGMFC6ZCOINLEE6KUPFYDOQLXMY3E4OCDGJQTGVCQF5HFQT2GNBEWQTSMIVHXSTJLGVJESTBQPBKVQSCUPBBTKSSXNVLC6YL2JBCVAQ2ONUFFAQ3WJYXUSVSNKNDVGVRYJYZFCURSOBGG4M3GKB2WC3CLHEZUKYSXPF4GG5KBNRUUW3BWFN5EG6JSLFHUE4CLGBRWK6LGINDXCVZRGMFFKOLVG52VC5LROIYGGT2ILI3TCM22GB5EU2COONYUSL3VJ5ZVGS2KMNDGIK2QHBGXM3CMLF4UWQ2BM5UXKK3KII3TAQ2IKQ2VC5LRN4FHC6DTKRKE2TTYKRRTG6RLLB3HU2TSMRXFSODBKFRDIY3XOM2TCL2VNFSC6M2XNNCTSOCUOFHXK2KIOVRS6MDQONRUUSTNKJEHK6CJHAFG45SYJNEUIR3KO4VXI5KGKAYVMKZPII3TCMLLIV4UYQLPGBVVUTDTPF4FQYLJMZ3VGOJXJIVTOVDDI5WHCN2NK5RTEURQPFBTIQ3UIQFHEMLXGB2VUZLSO5NHE2TSLFSVOVJYFNHDA43LO5BVMS3JKAXVM4C2LBXHSWSXNNISWVZWKZNDGOCNGJ3UEU3XINKFIMSFIZSW24LDPIFHIWLFOFHTS5CFOJ2WKQJQIFTVEWSXOVFVK2ZSIEYEW4JRHFRUCYRPGNHFONKOGBWTENJQME2VOSCOFNYXO3DWGFBXA2BXMJEUONZVKQFFQZTRGIZWSULKNBRVINSKJNDGWL2QGJJGQNDVLA3XMU3XPAVUITKRNNYGWQLGNZWVCSCFJRXFQVLGJFKEGL2PPI2WWZKKGBKTSN2CMYFDMTCIHE3XOZTINFBFKSZSO44W6ZLEJ4YEQWTSIE2VOL3JF5KEWNJYJBLXAYLWJNBFUZKEMZYHIRCGNZKVM4SPLFTFUT3ZKY4EY4LIOYFES6SDPFVHOV2WNNFVARTJLE2UK5DFKZAU44LKMRBXOSTNGBVUEMRQF54ECM2MNRFWU5LLK5IXE6JXGZZHQNLPNZGUGQLXIVAUCUJ5HUFC2LJNFUWUKTSEEBIFKQSMJFBSAS2FLEWS2LJNFUFA

`
)

func TestNewRSAEncrypt_Decrypt(t *testing.T) {
	plainText := "hello this will be encrypted and decrypted"

	enc, err := ende.NewRSAEncrypt(PublicKeyBase32)
	assert.NotNil(t, enc)
	assert.NoError(t, err)

	cipherText, err := enc.Encrypt(context.Background(), plainText)
	assert.NotEmpty(t, cipherText)
	assert.NoError(t, err)

	dec, err := ende.NewRSADecrypt(PrivateKeyBase32)
	assert.NotNil(t, dec)
	assert.NoError(t, err)

	plainString, err := dec.Decrypt(context.Background(), cipherText)
	assert.NotEmpty(t, plainString)
	assert.NoError(t, err)
	assert.Equal(t, plainText, plainString)
	t.Logf("CIPHER TEXT:\n%s\n", cipherText)
	t.Logf("PLAIN  TEXT:\n%s\n", plainString)
}
